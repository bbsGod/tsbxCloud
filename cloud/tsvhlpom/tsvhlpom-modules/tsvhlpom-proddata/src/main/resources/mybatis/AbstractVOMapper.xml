<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tsvhlpom.proddata.mapper.AbstractVOMapper">
    <resultMap id="result" type="com.tsvhlpom.proddata.domain.AbstractVO">
        <result property="c_type" column="c_type"></result>
        <result property="c_app_no" column="c_app_no"></result>
        <result property="c_email" column="c_email"></result>
        <result property="n_novhl_pay_amt" column="n_novhl_pay_amt"></result>
        <result property="c_charge_cde" column="c_charge_cde"></result>
        <result property="t_charge_tm" column="t_charge_tm"></result>
    </resultMap>
    <select id="selectEmail" resultMap="result">
        select c_app_no,c_email from web_app_applicant where c_app_no = #{c_app_no}
    </select>

    <select id="selectN_novhl_pay_amt" resultMap="result">
        select c_app_no,n_novhl_pay_amt,c_charge_cde,t_charge_tm from WEB_PAY_CONFIRM_INFO where c_app_no = #{c_app_no}
    </select>
    <update id="updatWebPayConfirmInfo">
        UPDATE WEB_PAY_CONFIRM_INFO I1
        SET i1.T_Charge_Tm =
        (SELECT i.T_Charge_Tm
        FROM WEB_PAY_CONFIRM_INFO I
        where I.C_Charge_Cde IS NOT NULL
        AND I.C_BATCH_NO = I1.C_BATCH_NO
        and ROWNUM &lt;= 1),
        i1.c_charge_cde =
        (SELECT i.c_charge_cde
        FROM WEB_PAY_CONFIRM_INFO I
        where I.C_Charge_Cde IS NOT NULL
        AND I.C_BATCH_NO = I1.C_BATCH_NO
        and ROWNUM &lt;= 1)
        where I1.C_PAY_TYP = '1'
        AND I1.C_CHECK_STS = '4'
        AND I1.C_PAY_STATUS = '1'
        AND I1.T_PAY_CONF_TM BETWEEN
        TO_DATE(concat(to_char(sysdate-1,'yyyy-mm-dd'), ' 00:00:00'), 'yyyy-mm-dd hh24:mi:ss') AND
        TO_DATE(concat(to_char(sysdate-1,'yyyy-mm-dd'), ' 23:59:59'), 'yyyy-mm-dd hh24:mi:ss')
        AND I1.C_Charge_Cde IS NULL

    </update>
    <update id="updatWebPayConfirmInfoByDate">
        UPDATE WEB_PAY_CONFIRM_INFO I1
        SET i1.T_Charge_Tm =
        (SELECT i.T_Charge_Tm
        FROM WEB_PAY_CONFIRM_INFO I
        where I.C_Charge_Cde IS NOT NULL
        AND I.C_BATCH_NO = I1.C_BATCH_NO
        and ROWNUM &lt;= 1),
        i1.c_charge_cde =
        (SELECT i.c_charge_cde
        FROM WEB_PAY_CONFIRM_INFO I
        where I.C_Charge_Cde IS NOT NULL
        AND I.C_BATCH_NO = I1.C_BATCH_NO
        and ROWNUM &lt;= 1)
        where I1.C_PAY_TYP = '1'
        AND I1.C_CHECK_STS = '4'
        AND I1.C_PAY_STATUS = '1'
        AND I1.T_PAY_CONF_TM BETWEEN
        TO_DATE(concat(#{startDate}, ' 00:00:00'), 'yyyy-mm-dd hh24:mi:ss') AND
        TO_DATE(concat(#{endDate}, ' 23:59:59'), 'yyyy-mm-dd hh24:mi:ss')
        AND I1.C_Charge_Cde IS NULL

    </update>

    <update id="updateTimeByExport" parameterType="com.tsvhlpom.proddata.domain.AbstractVO">
        update web_bas_customers set t_create_date = #{t_create_date} where c_pk_id = #{c_pk_id}
    </update>

    <update id="updateAppCvrg">
        update web_app_cvrg r
        set r.n_base_prm = 0.00, r.n_bef_prm = 0.00, r.n_bef_ann_prm = 0.00
        where r.c_app_no in ('009050303202021002744',
        '002170103202021007522',
        '009011603202021012162',
        '001142403202021002883',
        '009100103202021008810',
        '006010103202021000099',
        '009010303202021004653',
        '009011603202021012206',
        '005080103202021002798',
        '010010203202021003317',
        '009010303202021004654',
        '001018103202021003425',
        '010030103202021017584',
        '010010303202021005435',
        '009070103202021008155',
        '009070103202021008143',
        '004100103202021000117',
        '010010303202021005706',
        '009011603202021012165',
        '010010303202021005689',
        '009011603202021012261',
        '002170103202021007519',
        '001084203202021001064',
        '010010203202021003328',
        '009070103202021008181',
        '009090203202021003442',
        '005070203202021003316',
        '009050303202021002752',
        '009011603202021012262',
        '010010303202021005711',
        '006043203202021000379',
        '010030103202021017468',
        '009011603202021012247',
        '009050303202021002746',
        '010010203202021003315',
        '005070203202021003317',
        '010010203202021003331',
        '010010303202021005720',
        '001048203202021003484',
        '010010203202021003333',
        '009011603202021012194',
        '010010203202021003321',
        '009070103202021008192',
        '009011603202021012266',
        '010010303202021005701',
        '009050303202021002761',
        '006010103202021000098',
        '010010203202021003340',
        '009011603202021012166',
        '005070203202021003303',
        '005070203202021003315',
        '010010303202021005703',
        '009070103202021008167',
        '009011603202021012172',
        '006043203202021000376',
        '009050303202021002749',
        '005070203202021003320',
        '009070103202021007030',
        '009070103202021008140',
        '010010303202021005715',
        '009011603202021012171',
        '010010303202021005716',
        '005070203202021003334',
        '001094203202021001132',
        '009070103202021008179',
        '005070203202021003311',
        '001090203202021000093',
        '006043203202021000380',
        '010010203202021003330',
        '009130103202021003077',
        '010030103202021017525',
        '010030103202021017519',
        '010030103202021017545',
        '009020103202021002334',
        '009090203202021003440',
        '009010303202021004677',
        '010010203202021003322',
        '009010303202021004680',
        '006010103202021000100',
        '009090203202021003465',
        '010010303202021005723',
        '009070103202021008159',
        '009011603202021012233',
        '006010103202021000102',
        '010010203202021003334',
        '010010203202021003325',
        '005080103202021002749',
        '009070103202021008201',
        '010010203202021003329',
        '010010303202021005726',
        '009090203202021003456',
        '010010203202021003335',
        '006010103202021000101',
        '001131203202021003112',
        '005040603202021000977',
        '009050303202021002781',
        '010030103202021017496',
        '009011603202021012188',
        '009090203202021003461',
        '006043203202021000375',
        '002170103202021007523',
        '010010203202021003337',
        '009011603202021012197',
        '006043203202021000377',
        '010010303202021005699',
        '005070203202021003342',
        '010010203202021003338',
        '009050303202021002759',
        '006040203202021001485',
        '005060203202021003434',
        '005070203202021003341',
        '009050303202021002789',
        '010010203202021003336',
        '010010203202021003318',
        '009011603202021012203',
        '009070103202021008188',
        '002170103202021007462',
        '009090203202021003459',
        '009100103202021008777',
        '006043203202021000378',
        '010010203202021003327',
        '001018103202022005627')
        and r.c_cvrg_no &lt;&gt; '030055'
        and r.n_base_prm &lt;&gt; 0.00
    </update>
    <update id="updatePlyCvrg">
        update web_ply_cvrg r
        set r.n_base_prm = 0.00, r.n_bef_prm = 0.00, r.n_bef_ann_prm = 0.00
        where r.c_app_no in ('009050303202021002744',
        '002170103202021007522',
        '009011603202021012162',
        '001142403202021002883',
        '009100103202021008810',
        '006010103202021000099',
        '009010303202021004653',
        '009011603202021012206',
        '005080103202021002798',
        '010010203202021003317',
        '009010303202021004654',
        '001018103202021003425',
        '010030103202021017584',
        '010010303202021005435',
        '009070103202021008155',
        '009070103202021008143',
        '004100103202021000117',
        '010010303202021005706',
        '009011603202021012165',
        '010010303202021005689',
        '009011603202021012261',
        '002170103202021007519',
        '001084203202021001064',
        '010010203202021003328',
        '009070103202021008181',
        '009090203202021003442',
        '005070203202021003316',
        '009050303202021002752',
        '009011603202021012262',
        '010010303202021005711',
        '006043203202021000379',
        '010030103202021017468',
        '009011603202021012247',
        '009050303202021002746',
        '010010203202021003315',
        '005070203202021003317',
        '010010203202021003331',
        '010010303202021005720',
        '001048203202021003484',
        '010010203202021003333',
        '009011603202021012194',
        '010010203202021003321',
        '009070103202021008192',
        '009011603202021012266',
        '010010303202021005701',
        '009050303202021002761',
        '006010103202021000098',
        '010010203202021003340',
        '009011603202021012166',
        '005070203202021003303',
        '005070203202021003315',
        '010010303202021005703',
        '009070103202021008167',
        '009011603202021012172',
        '006043203202021000376',
        '009050303202021002749',
        '005070203202021003320',
        '009070103202021007030',
        '009070103202021008140',
        '010010303202021005715',
        '009011603202021012171',
        '010010303202021005716',
        '005070203202021003334',
        '001094203202021001132',
        '009070103202021008179',
        '005070203202021003311',
        '001090203202021000093',
        '006043203202021000380',
        '010010203202021003330',
        '009130103202021003077',
        '010030103202021017525',
        '010030103202021017519',
        '010030103202021017545',
        '009020103202021002334',
        '009090203202021003440',
        '009010303202021004677',
        '010010203202021003322',
        '009010303202021004680',
        '006010103202021000100',
        '009090203202021003465',
        '010010303202021005723',
        '009070103202021008159',
        '009011603202021012233',
        '006010103202021000102',
        '010010203202021003334',
        '010010203202021003325',
        '005080103202021002749',
        '009070103202021008201',
        '010010203202021003329',
        '010010303202021005726',
        '009090203202021003456',
        '010010203202021003335',
        '006010103202021000101',
        '001131203202021003112',
        '005040603202021000977',
        '009050303202021002781',
        '010030103202021017496',
        '009011603202021012188',
        '009090203202021003461',
        '006043203202021000375',
        '002170103202021007523',
        '010010203202021003337',
        '009011603202021012197',
        '006043203202021000377',
        '010010303202021005699',
        '005070203202021003342',
        '010010203202021003338',
        '009050303202021002759',
        '006040203202021001485',
        '005060203202021003434',
        '005070203202021003341',
        '009050303202021002789',
        '010010203202021003336',
        '010010203202021003318',
        '009011603202021012203',
        '009070103202021008188',
        '002170103202021007462',
        '009090203202021003459',
        '009100103202021008777',
        '006043203202021000378',
        '010010203202021003327',
        '001018103202022005627')
        and r.c_cvrg_no &lt;&gt; '030055'
        and r.n_base_prm &lt;&gt; 0.00
    </update>

</mapper>
